<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>数を大きくしていくゲーム</title>
<style>
    body {
        font-family: sans-serif;
        background: #f3f3f3;
        margin: 0;
        padding: 0;
        display: flex;
        min-height: 100vh;
        align-items: center;
        justify-content: center;
    }

    /* ★ スマホ画面いっぱいにするため width:100% */
    .game-container {
        background: #ffffff;
        border-radius: 0;
        box-shadow: none;
        padding: 20px;
        width: 100%;
        max-width: 900px; /* PCでは広く */
    }

    h1 {
        margin: 0 0 16px;
        font-size: 2rem;
        text-align: center;
    }

    .description {
        font-size: 1.2rem;
        margin-bottom: 20px;
        line-height: 1.5;
    }

    .label-row {
        display: flex;
        justify-content: space-between;
        font-size: 1.1rem;
        margin-bottom: 6px;
    }

    /* ★ 数値部分大きく */
    .number-display {
        background: #111;
        color: #0ff;
        padding: 18px;
        border-radius: 12px;
        font-family: monospace;
        font-size: 1.6rem;
        word-break: break-all;
        margin-bottom: 20px;
    }

    .status-row {
        display: flex;
        justify-content: space-between;
        font-size: 1.2rem;
        margin-bottom: 12px;
    }

    .options-title {
        font-size: 1.4rem;
        margin: 12px 0;
    }

    /* ★ ボタンを大きく、スマホで2列+余白 */
    .options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(45%, 1fr));
        gap: 12px;
        margin-bottom: 20px;
    }

    .option-btn {
        padding: 18px 14px;
        border-radius: 12px;
        border: 2px solid #ddd;
        background: #fafafa;
        cursor: pointer;
        font-size: 1.4rem;
        font-family: monospace;
        transition: background 0.1s;
    }
    .option-btn:hover {
        background: #e9f6ff;
    }

    /* ★ 下ボタン大きく */
    .controls {
        display: flex;
        gap: 12px;
        margin-top: 10px;
        flex-wrap: wrap;
    }

    .controls button {
        flex: 1 1 48%;
        padding: 18px;
        border-radius: 50px;
        border: none;
        cursor: pointer;
        font-size: 1.3rem;
    }

    .btn-reset {
        background: #eee;
    }
    .btn-reset:hover {
        background: #ddd;
    }

    .btn-hard {
        background: #ffe0e0;
    }
    .btn-hard:hover {
        background: #ffcccc;
    }

    .note {
        margin-top: 16px;
        font-size: 1.1rem;
        color: #777;
        line-height: 1.6;
    }
</style>
</head>
<body>

<div class="game-container">
    <h1>数を大きくしていくゲーム</h1>

    <p class="description">
        最初は <strong>100</strong> からスタート。  
        毎ターン、現在の数値の <strong>0.95倍〜1.05倍</strong> のランダムな候補が5つ表示されます。  
        好きな数を選んで巨大な数に育てよう！
    </p>

    <div class="label-row">
        <span>現在の数値</span>
        <span>10桁以内は通常表示</span>
    </div>

    <div id="currentValue" class="number-display">-</div>

    <div class="status-row">
        <span>ターン：<span id="turnCount">0</span></span>
        <span>最大値：<span id="maxValueLabel">-</span></span>
    </div>

    <div class="options-title">候補を選んでください：</div>
    <div id="options" class="options"></div>

    <div class="controls">
        <button class="btn-reset" id="resetBtn">リセット（100に戻す）</button>
        <button class="btn-hard" id="hardBtn">ハードモード</button>
    </div>

    <p class="note">
        ※巨大数は「1.2345678901 × 10の123乗」で表示されます。  
        ※ハードモードは0.90〜1.10倍になります。
    </p>
</div>

<script>
(function() {
    let current = { mantissa: 1, exponent: 2 };
    let maxValue = { mantissa: 1, exponent: 2 };
    let turnCount = 0;
    let hardMode = false;

    const currentValueEl = document.getElementById('currentValue');
    const optionsEl = document.getElementById('options');
    const turnCountEl = document.getElementById('turnCount');
    const maxValueLabelEl = document.getElementById('maxValueLabel');
    const resetBtn = document.getElementById('resetBtn');
    const hardBtn = document.getElementById('hardBtn');

    function normalize(mantissa, exponent) {
        if (mantissa === 0) return { mantissa: 0, exponent: 0 };
        while (Math.abs(mantissa) >= 10) { mantissa /= 10; exponent++; }
        while (Math.abs(mantissa) < 1)  { mantissa *= 10; exponent--; }
        return { mantissa, exponent };
    }

    /* ★ 10桁以内なら通常表示 */
    function formatScientific(val) {
        const m = val.mantissa;
        const e = val.exponent;

        if (e >= 0 && e <= 9) {
            let normal = m * Math.pow(10, e);
            let str = Math.round(normal).toString();
            if (str.length <= 10) return str;
        }
        return m.toFixed(10) + " × 10の" + e + "乗";
    }

    function compareValue(a, b) {
        if (a.exponent !== b.exponent) return a.exponent > b.exponent ? 1 : -1;
        if (a.mantissa !== b.mantissa) return a.mantissa > b.mantissa ? 1 : -1;
        return 0;
    }

    function updateDisplay() {
        currentValueEl.textContent = formatScientific(current);
        maxValueLabelEl.textContent = formatScientific(maxValue);
        turnCountEl.textContent = turnCount;
        generateOptions();
    }

    function generateOptions() {
        optionsEl.innerHTML = "";

        let options = [];
        let hasGreater = false;

        const minFactor = hardMode ? 0.90 : 0.95;
        const maxFactor = hardMode ? 1.10 : 1.05;

        for (let i = 0; i < 5; i++) {
            let factor = minFactor + (maxFactor - minFactor) * Math.random();
            if (factor > 1) hasGreater = true;

            let m = current.mantissa * factor;
            let e = current.exponent;
            const normalized = normalize(m, e);

            options.push({ value: normalized });
        }

        if (!hasGreater) {
            const factor = 1 + (maxFactor - 1) * Math.random();
            const normalized = normalize(current.mantissa * factor, current.exponent);
            options[4] = { value: normalized };
        }

        options.forEach(opt => {
            const btn = document.createElement("button");
            btn.className = "option-btn";
            btn.innerHTML = formatScientific(opt.value);
            btn.onclick = () => chooseOption(opt.value);
            optionsEl.appendChild(btn);
        });
    }

    function chooseOption(newValue) {
        current = normalize(newValue.mantissa, newValue.exponent);
        turnCount++;

        if (compareValue(current, maxValue) > 0) {
            maxValue = { ...current };
        }
        updateDisplay();
    }

    function resetGame() {
        current = { mantissa: 1, exponent: 2 };
        maxValue = { mantissa: 1, exponent: 2 };
        turnCount = 0;
        hardMode = false;
        hardBtn.textContent = "ハードモード";
        updateDisplay();
    }

    function toggleHardMode() {
        hardMode = !hardMode;
        hardBtn.textContent = hardMode ? "ハードモード中" : "ハードモード";
        generateOptions();
    }

    resetBtn.onclick = resetGame;
    hardBtn.onclick = toggleHardMode;

    updateDisplay();
})();
</script>

</body>
</html>
